From 2ba541aef3b6953a2e2e7ddc0d940c81810da72f Mon Sep 17 00:00:00 2001
From: "H.J. Lu" <hjl.tools@gmail.com>
Date: Mon, 27 Apr 2020 05:09:55 -0700
Subject: [PATCH] Update Intel CET patches for Linux kernel 5.7-rc2 2

Replace might_sleep with cond_resched
---
 ...fpu-xstate-Rename-validate_xstate_header-to-vali.patch | 4 ++--
 ...fpu-xstate-Define-new-macros-for-supervisor-and-.patch | 4 ++--
 ...fpu-xstate-Separate-user-and-supervisor-xfeature.patch | 4 ++--
 ...86-fpu-xstate-Introduce-XSAVES-supervisor-states.patch | 4 ++--
 ...fpu-xstate-Define-new-functions-for-clearing-fpr.patch | 4 ++--
 ...fpu-xstate-Update-sanitize_restored_xstate-for-s.patch | 4 ++--
 ...fpu-xstate-Update-copy_kernel_to_xregs_err-for-X.patch | 4 ++--
 0008-x86-fpu-Introduce-copy_supervisor_to_kernel.patch    | 4 ++--
 ...fpu-xstate-Preserve-supervisor-states-for-slow-p.patch | 4 ++--
 ...fpu-xstate-Restore-supervisor-states-for-signal-.patch | 4 ++--
 0011-Documentation-x86-Add-CET-description.patch          | 4 ++--
 ...cpufeatures-Add-CET-CPU-feature-flags-for-Contro.patch | 4 ++--
 ...fpu-xstate-Introduce-CET-MSR-XSAVES-supervisor-s.patch | 4 ++--
 0014-x86-cet-Add-control-protection-fault-handler.patch   | 4 ++--
 ...cet-shstk-Add-Kconfig-option-for-user-mode-Shado.patch | 4 ++--
 0016-x86-mm-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_HW.patch    | 4 ++--
 ...86-mm-Remove-_PAGE_DIRTY_HW-from-kernel-RO-pages.patch | 4 ++--
 0018-x86-mm-Introduce-_PAGE_COW.patch                     | 4 ++--
 ...-i915-gvt-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_BITS.patch | 4 ++--
 ...mm-Update-pte_modify-and-pmd_modify-for-_PAGE_CO.patch | 4 ++--
 ...mm-Update-ptep_set_wrprotect-and-pmdp_set_wrprot.patch | 4 ++--
 0022-mm-Introduce-VM_SHSTK-for-Shadow-Stack-memory.patch  | 4 ++--
 0023-x86-mm-Shadow-Stack-page-fault-error-checking.patch  | 4 ++--
 ...mm-Update-is_cow_mapping-and-maybe_mkwrite-for-s.patch | 4 ++--
 0025-mm-Update-do_anonymous_page-and-do_numa_page.patch   | 4 ++--
 ...-mm-Update-can_follow_write_pte-for-Shadow-Stack.patch | 4 ++--
 0027-x86-mm-Add-guard-pages-around-a-Shadow-Stack.patch   | 4 ++--
 ...mmap-Add-Shadow-Stack-pages-to-memory-accounting.patch | 4 ++--
 0029-x86-cet-shstk-User-mode-Shadow-Stack-support.patch   | 8 ++++----
 0030-x86-cet-shstk-Handle-signals-for-Shadow-Stack.patch  | 6 +++---
 ...UAPI-and-Kconfig-additions-for-ELF-program-prope.patch | 4 ++--
 0032-ELF-Add-ELF-program-property-parsing-support.patch   | 4 ++--
 0033-ELF-Introduce-arch_setup_elf_property.patch          | 4 ++--
 ...86-cet-shstk-ELF-header-parsing-for-Shadow-Stack.patch | 4 ++--
 0035-x86-cet-shstk-Handle-thread-Shadow-Stack.patch       | 6 +++---
 ...cet-shstk-Add-arch_prctl-functions-for-Shadow-St.patch | 6 +++---
 ...cet-ibt-Add-Kconfig-option-for-user-mode-Indirec.patch | 4 ++--
 ...cet-ibt-User-mode-Indirect-Branch-Tracking-suppo.patch | 6 +++---
 ...cet-ibt-Handle-signals-for-Indirect-Branch-Track.patch | 6 +++---
 ...cet-ibt-ELF-header-parsing-for-Indirect-Branch-T.patch | 4 ++--
 ...cet-ibt-Add-arch_prctl-functions-for-Indirect-Br.patch | 4 ++--
 0042-x86-cet-Add-PTRACE-interface-for-CET.patch           | 4 ++--
 ...ard-.note.gnu.property-sections-in-generic-NOTES.patch | 4 ++--
 ...vdso-32-Add-ENDBR32-to-__kernel_vsyscall-entry-p.patch | 4 ++--
 0045-x86-vdso-Insert-endbr32-endbr64-to-vDSO.patch        | 4 ++--
 ...-Disallow-vsyscall-emulation-when-CET-is-enabled.patch | 4 ++--
 46 files changed, 99 insertions(+), 99 deletions(-)

diff --git a/0001-x86-fpu-xstate-Rename-validate_xstate_header-to-vali.patch b/0001-x86-fpu-xstate-Rename-validate_xstate_header-to-vali.patch
index 4534eee75..c39bfe78f 100644
--- a/0001-x86-fpu-xstate-Rename-validate_xstate_header-to-vali.patch
+++ b/0001-x86-fpu-xstate-Rename-validate_xstate_header-to-vali.patch
@@ -1,4 +1,4 @@
-From ab7af4a002ee4f899d496dbe58b600e9a724824b Mon Sep 17 00:00:00 2001
+From d0dd3ca22227bbe2b8ff8500aebe16665527faf7 Mon Sep 17 00:00:00 2001
 From: Fenghua Yu <fenghua.yu@intel.com>
 Date: Wed, 13 Dec 2017 16:08:28 -0800
 Subject: [PATCH 01/46] x86/fpu/xstate: Rename validate_xstate_header() to
@@ -94,5 +94,5 @@ index 32b153d38748..8ed64397c78b 100644
  
  	for (i = 0; i < XFEATURE_MAX; i++) {
 -- 
-2.26.0
+2.26.1
 
diff --git a/0002-x86-fpu-xstate-Define-new-macros-for-supervisor-and-.patch b/0002-x86-fpu-xstate-Define-new-macros-for-supervisor-and-.patch
index df6dd02ac..09d8a884e 100644
--- a/0002-x86-fpu-xstate-Define-new-macros-for-supervisor-and-.patch
+++ b/0002-x86-fpu-xstate-Define-new-macros-for-supervisor-and-.patch
@@ -1,4 +1,4 @@
-From b9c24982c4d0015a8326d51a4480ff1800343b59 Mon Sep 17 00:00:00 2001
+From 736f1e23d3c53f356a05c0d3c483a6b6fb412992 Mon Sep 17 00:00:00 2001
 From: Fenghua Yu <fenghua.yu@intel.com>
 Date: Thu, 10 Nov 2016 10:13:56 -0800
 Subject: [PATCH 02/46] x86/fpu/xstate: Define new macros for supervisor and
@@ -180,5 +180,5 @@ index 8ed64397c78b..9997df717339 100644
  	/*
  	 * Add back in the features that came in from userspace:
 -- 
-2.26.0
+2.26.1
 
diff --git a/0003-x86-fpu-xstate-Separate-user-and-supervisor-xfeature.patch b/0003-x86-fpu-xstate-Separate-user-and-supervisor-xfeature.patch
index db2919bd4..a97134b92 100644
--- a/0003-x86-fpu-xstate-Separate-user-and-supervisor-xfeature.patch
+++ b/0003-x86-fpu-xstate-Separate-user-and-supervisor-xfeature.patch
@@ -1,4 +1,4 @@
-From 598097e6a0656f9bdddc983dcd4c89e6c1180c80 Mon Sep 17 00:00:00 2001
+From d336c82158e8051ef7c3769c09a1a88475899560 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Wed, 13 Dec 2017 16:08:28 -0800
 Subject: [PATCH 03/46] x86/fpu/xstate: Separate user and supervisor xfeatures
@@ -349,5 +349,5 @@ index 9997df717339..fa71af643025 100644
  	/*
  	 * Copy xregs_state->header:
 -- 
-2.26.0
+2.26.1
 
diff --git a/0004-x86-fpu-xstate-Introduce-XSAVES-supervisor-states.patch b/0004-x86-fpu-xstate-Introduce-XSAVES-supervisor-states.patch
index 0c9fa650f..cc7c943a7 100644
--- a/0004-x86-fpu-xstate-Introduce-XSAVES-supervisor-states.patch
+++ b/0004-x86-fpu-xstate-Introduce-XSAVES-supervisor-states.patch
@@ -1,4 +1,4 @@
-From 72d04f5a6a9b1c7b7d22fec30e19d5d74d8a022c Mon Sep 17 00:00:00 2001
+From 2c3c6fbdb39595c0ca944b8390bce25a4fb3c639 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 10 Nov 2016 10:13:56 -0800
 Subject: [PATCH 04/46] x86/fpu/xstate: Introduce XSAVES supervisor states
@@ -81,5 +81,5 @@ index fa71af643025..a68213ed5be6 100644
  
  /*
 -- 
-2.26.0
+2.26.1
 
diff --git a/0005-x86-fpu-xstate-Define-new-functions-for-clearing-fpr.patch b/0005-x86-fpu-xstate-Define-new-functions-for-clearing-fpr.patch
index 9f6765bbb..700abdaf3 100644
--- a/0005-x86-fpu-xstate-Define-new-functions-for-clearing-fpr.patch
+++ b/0005-x86-fpu-xstate-Define-new-functions-for-clearing-fpr.patch
@@ -1,4 +1,4 @@
-From b9a03d653a44f89354b5983156529d35521e4e06 Mon Sep 17 00:00:00 2001
+From f96afa328e2fe1975eefb44bfb36e0b1a1d3301e Mon Sep 17 00:00:00 2001
 From: Fenghua Yu <fenghua.yu@intel.com>
 Date: Thu, 10 Nov 2016 10:13:56 -0800
 Subject: [PATCH 05/46] x86/fpu/xstate: Define new functions for clearing
@@ -178,5 +178,5 @@ index 83b74fb38c8f..0052bbe5dfd4 100644
  	signal_setup_done(failed, ksig, stepping);
  }
 -- 
-2.26.0
+2.26.1
 
diff --git a/0006-x86-fpu-xstate-Update-sanitize_restored_xstate-for-s.patch b/0006-x86-fpu-xstate-Update-sanitize_restored_xstate-for-s.patch
index 3921b782e..b1c2e3b3e 100644
--- a/0006-x86-fpu-xstate-Update-sanitize_restored_xstate-for-s.patch
+++ b/0006-x86-fpu-xstate-Update-sanitize_restored_xstate-for-s.patch
@@ -1,4 +1,4 @@
-From 7d03289e9a416e0407ea05363fe6e8e8442118e0 Mon Sep 17 00:00:00 2001
+From fd92d8b54bc60d0e680301a1acb1cd90d4c7fa50 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 12 Nov 2019 09:09:10 -0800
 Subject: [PATCH 06/46] x86/fpu/xstate: Update sanitize_restored_xstate() for
@@ -133,5 +133,5 @@ index cd6eafba12da..d09d72334a12 100644
  		fpregs_lock();
  		if (use_xsave()) {
 -- 
-2.26.0
+2.26.1
 
diff --git a/0007-x86-fpu-xstate-Update-copy_kernel_to_xregs_err-for-X.patch b/0007-x86-fpu-xstate-Update-copy_kernel_to_xregs_err-for-X.patch
index 5555449a1..d2b874080 100644
--- a/0007-x86-fpu-xstate-Update-copy_kernel_to_xregs_err-for-X.patch
+++ b/0007-x86-fpu-xstate-Update-copy_kernel_to_xregs_err-for-X.patch
@@ -1,4 +1,4 @@
-From a05c6087c855f278cbf559d727a8ebe85adee9c6 Mon Sep 17 00:00:00 2001
+From eef73dcb50a2407de922ef8e8f65a34cfa8de5e6 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 29 Oct 2019 12:42:06 -0700
 Subject: [PATCH 07/46] x86/fpu/xstate: Update copy_kernel_to_xregs_err() for
@@ -43,5 +43,5 @@ index a42fcb4b690d..42159f45bf9c 100644
  	return err;
  }
 -- 
-2.26.0
+2.26.1
 
diff --git a/0008-x86-fpu-Introduce-copy_supervisor_to_kernel.patch b/0008-x86-fpu-Introduce-copy_supervisor_to_kernel.patch
index 5a5a13d9e..e047401ef 100644
--- a/0008-x86-fpu-Introduce-copy_supervisor_to_kernel.patch
+++ b/0008-x86-fpu-Introduce-copy_supervisor_to_kernel.patch
@@ -1,4 +1,4 @@
-From 1eb33da552f492b352c3c5ae05a55a90d15fde0e Mon Sep 17 00:00:00 2001
+From 4b53db43eb933b3af205a891511c37f9835cdfa4 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Mon, 16 Mar 2020 10:29:12 -0700
 Subject: [PATCH 08/46] x86/fpu: Introduce copy_supervisor_to_kernel()
@@ -150,5 +150,5 @@ index a68213ed5be6..587e03f0094d 100644
  /*
   * Report the amount of time elapsed in millisecond since last AVX512
 -- 
-2.26.0
+2.26.1
 
diff --git a/0009-x86-fpu-xstate-Preserve-supervisor-states-for-slow-p.patch b/0009-x86-fpu-xstate-Preserve-supervisor-states-for-slow-p.patch
index d9fa04461..cbc88336f 100644
--- a/0009-x86-fpu-xstate-Preserve-supervisor-states-for-slow-p.patch
+++ b/0009-x86-fpu-xstate-Preserve-supervisor-states-for-slow-p.patch
@@ -1,4 +1,4 @@
-From 20686fac99fa687e7b2f02bc23cc7cc868edf0a5 Mon Sep 17 00:00:00 2001
+From 69fddb3e15935dec61ce57dd4220a751dd9ab805 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 29 Oct 2019 13:03:10 -0700
 Subject: [PATCH 09/46] x86/fpu/xstate: Preserve supervisor states for slow
@@ -135,5 +135,5 @@ index d09d72334a12..545ca4314096 100644
  	if (use_xsave() && !fx_only) {
  		u64 init_bv = xfeatures_mask_user() & ~user_xfeatures;
 -- 
-2.26.0
+2.26.1
 
diff --git a/0010-x86-fpu-xstate-Restore-supervisor-states-for-signal-.patch b/0010-x86-fpu-xstate-Restore-supervisor-states-for-signal-.patch
index 543500736..baae796b3 100644
--- a/0010-x86-fpu-xstate-Restore-supervisor-states-for-signal-.patch
+++ b/0010-x86-fpu-xstate-Restore-supervisor-states-for-signal-.patch
@@ -1,4 +1,4 @@
-From 6bd978fecb7a753da35daaac1e99ea98d7df61bf Mon Sep 17 00:00:00 2001
+From 7ff5712cee8e7ba8913cae898582ed0aa11ea256 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Fri, 27 Mar 2020 09:42:02 -0700
 Subject: [PATCH 10/46] x86/fpu/xstate: Restore supervisor states for signal
@@ -108,5 +108,5 @@ index 545ca4314096..4dad5afc938d 100644
  	} else if (use_fxsr()) {
  		ret = __copy_from_user(&fpu->state.fxsave, buf_fx, state_size);
 -- 
-2.26.0
+2.26.1
 
diff --git a/0011-Documentation-x86-Add-CET-description.patch b/0011-Documentation-x86-Add-CET-description.patch
index 15dd06531..d9eee183b 100644
--- a/0011-Documentation-x86-Add-CET-description.patch
+++ b/0011-Documentation-x86-Add-CET-description.patch
@@ -1,4 +1,4 @@
-From 5d54f6a5b7f3dfea91f77cbd859b0987f428f9b6 Mon Sep 17 00:00:00 2001
+From 7f01ce5e8cdb2b5e23b60f31657fabf8cb6eb479 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Sun, 17 Dec 2017 09:09:23 -0800
 Subject: [PATCH 11/46] Documentation/x86: Add CET description
@@ -190,5 +190,5 @@ index 000000000000..746eda8c82f3
 +When a pthread child is created, the kernel allocates a new shadow stack
 +for the new thread.
 -- 
-2.26.0
+2.26.1
 
diff --git a/0012-x86-cpufeatures-Add-CET-CPU-feature-flags-for-Contro.patch b/0012-x86-cpufeatures-Add-CET-CPU-feature-flags-for-Contro.patch
index 060eac4db..56224e474 100644
--- a/0012-x86-cpufeatures-Add-CET-CPU-feature-flags-for-Contro.patch
+++ b/0012-x86-cpufeatures-Add-CET-CPU-feature-flags-for-Contro.patch
@@ -1,4 +1,4 @@
-From de5c791ef731300ec38cc6d6c78f94efb8b7dd67 Mon Sep 17 00:00:00 2001
+From b0b472e3b037101c01aee284c306550e97483a8c Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Wed, 9 Nov 2016 16:26:37 -0800
 Subject: [PATCH 12/46] x86/cpufeatures: Add CET CPU feature flags for
@@ -51,5 +51,5 @@ index 3cbe24ca80ab..fec83cc74b9e 100644
  };
  
 -- 
-2.26.0
+2.26.1
 
diff --git a/0013-x86-fpu-xstate-Introduce-CET-MSR-XSAVES-supervisor-s.patch b/0013-x86-fpu-xstate-Introduce-CET-MSR-XSAVES-supervisor-s.patch
index 865e85a33..146bb207e 100644
--- a/0013-x86-fpu-xstate-Introduce-CET-MSR-XSAVES-supervisor-s.patch
+++ b/0013-x86-fpu-xstate-Introduce-CET-MSR-XSAVES-supervisor-s.patch
@@ -1,4 +1,4 @@
-From 89469f78288948d9d6ff967fe6835d3ede105a5a Mon Sep 17 00:00:00 2001
+From dbe1258b8e7b344ba57e00bffb86c21948330315 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 10 Nov 2016 10:13:56 -0800
 Subject: [PATCH 13/46] x86/fpu/xstate: Introduce CET MSR XSAVES supervisor
@@ -199,5 +199,5 @@ index 587e03f0094d..7c7be482e6f3 100644
  
  	xfeatures_mask_all &= fpu__get_supported_xfeatures_mask();
 -- 
-2.26.0
+2.26.1
 
diff --git a/0014-x86-cet-Add-control-protection-fault-handler.patch b/0014-x86-cet-Add-control-protection-fault-handler.patch
index 58a49d77d..c60ec2aa4 100644
--- a/0014-x86-cet-Add-control-protection-fault-handler.patch
+++ b/0014-x86-cet-Add-control-protection-fault-handler.patch
@@ -1,4 +1,4 @@
-From 2908bc1b2067f1e0fcafdc8d188e08078dd28965 Mon Sep 17 00:00:00 2001
+From a75f840a57683a1b1f1465c4d809d8764a28ee9f Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 10 Nov 2016 13:17:46 -0800
 Subject: [PATCH 14/46] x86/cet: Add control-protection fault handler
@@ -186,5 +186,5 @@ index cb3d6c267181..693071dbe641 100644
  /*
   * SIGBUS si_codes
 -- 
-2.26.0
+2.26.1
 
diff --git a/0015-x86-cet-shstk-Add-Kconfig-option-for-user-mode-Shado.patch b/0015-x86-cet-shstk-Add-Kconfig-option-for-user-mode-Shado.patch
index 86e42de82..c728a7d92 100644
--- a/0015-x86-cet-shstk-Add-Kconfig-option-for-user-mode-Shado.patch
+++ b/0015-x86-cet-shstk-Add-Kconfig-option-for-user-mode-Shado.patch
@@ -1,4 +1,4 @@
-From 232bad5c07046a39e2257e83c02dbe8c21bfa155 Mon Sep 17 00:00:00 2001
+From 64a9c2a4a6ab29196b09dade489f3cd2f2666d65 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 3 Oct 2017 12:55:03 -0700
 Subject: [PATCH 15/46] x86/cet/shstk: Add Kconfig option for user-mode Shadow
@@ -80,5 +80,5 @@ index 000000000000..fac1d363a1b8
 +
 +echo "wrussq %rax, (%rbx)" | $* -x assembler -c -
 -- 
-2.26.0
+2.26.1
 
diff --git a/0016-x86-mm-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_HW.patch b/0016-x86-mm-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_HW.patch
index a169f0314..7c318658f 100644
--- a/0016-x86-mm-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_HW.patch
+++ b/0016-x86-mm-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_HW.patch
@@ -1,4 +1,4 @@
-From 68df1f30e079132efb61245caddf6945a8007489 Mon Sep 17 00:00:00 2001
+From 629a765ef18915c8e0ee4ce849b555e3ae6e0c53 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 12 Apr 2018 09:32:59 -0700
 Subject: [PATCH 16/46] x86/mm: Change _PAGE_DIRTY to _PAGE_DIRTY_HW
@@ -193,5 +193,5 @@ index 83050977490c..c24ecbb9aebd 100644
  				&tmp, i * sizeof(tmp), sizeof(tmp));
  		if (r < 0)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0017-x86-mm-Remove-_PAGE_DIRTY_HW-from-kernel-RO-pages.patch b/0017-x86-mm-Remove-_PAGE_DIRTY_HW-from-kernel-RO-pages.patch
index 6ab70fde5..0b5c1fe76 100644
--- a/0017-x86-mm-Remove-_PAGE_DIRTY_HW-from-kernel-RO-pages.patch
+++ b/0017-x86-mm-Remove-_PAGE_DIRTY_HW-from-kernel-RO-pages.patch
@@ -1,4 +1,4 @@
-From b41aaf2a631128b25e8d57d034b79d3e0ec9ada3 Mon Sep 17 00:00:00 2001
+From 55aef37d468c2e18f5cc75265b5fea11f587de4a Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 14 Apr 2020 14:48:14 -0700
 Subject: [PATCH 17/46] x86/mm: Remove _PAGE_DIRTY_HW from kernel RO pages
@@ -52,5 +52,5 @@ index 59eca6a94ce7..87751b7e2131 100644
  
  int set_memory_rw(unsigned long addr, int numpages)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0018-x86-mm-Introduce-_PAGE_COW.patch b/0018-x86-mm-Introduce-_PAGE_COW.patch
index 88ddb8268..e3b3cb8b6 100644
--- a/0018-x86-mm-Introduce-_PAGE_COW.patch
+++ b/0018-x86-mm-Introduce-_PAGE_COW.patch
@@ -1,4 +1,4 @@
-From d45b78ffd11ddb301c75a16501c0e60a44b46ff6 Mon Sep 17 00:00:00 2001
+From dc6d34ad649835234a09635b2557014c241f5e74 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Wed, 24 Jan 2018 10:27:13 -0800
 Subject: [PATCH 18/46] x86/mm: Introduce _PAGE_COW
@@ -364,5 +364,5 @@ index 522b80b952f4..4fff9acf9c20 100644
  
  /*
 -- 
-2.26.0
+2.26.1
 
diff --git a/0019-drm-i915-gvt-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_BITS.patch b/0019-drm-i915-gvt-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_BITS.patch
index ea4529685..2f67768ae 100644
--- a/0019-drm-i915-gvt-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_BITS.patch
+++ b/0019-drm-i915-gvt-Change-_PAGE_DIRTY-to-_PAGE_DIRTY_BITS.patch
@@ -1,4 +1,4 @@
-From 444c380ebd4259d6d1bffc9e1cac42ba6a9d8fa7 Mon Sep 17 00:00:00 2001
+From 8dc377a603eeea9c0e39790f25a77a87a2479743 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 28 Aug 2018 13:01:49 -0700
 Subject: [PATCH 19/46] drm/i915/gvt: Change _PAGE_DIRTY to _PAGE_DIRTY_BITS
@@ -33,5 +33,5 @@ index 2a4b23f8aa74..789dce23424b 100644
  	ops->clear_pse(se);
  	ops->clear_ips(se);
 -- 
-2.26.0
+2.26.1
 
diff --git a/0020-x86-mm-Update-pte_modify-and-pmd_modify-for-_PAGE_CO.patch b/0020-x86-mm-Update-pte_modify-and-pmd_modify-for-_PAGE_CO.patch
index 6c8e02d36..85863b1dd 100644
--- a/0020-x86-mm-Update-pte_modify-and-pmd_modify-for-_PAGE_CO.patch
+++ b/0020-x86-mm-Update-pte_modify-and-pmd_modify-for-_PAGE_CO.patch
@@ -1,4 +1,4 @@
-From 670620e225b349abdd61511023ecc917ccdbec5d Mon Sep 17 00:00:00 2001
+From 8becbf5cf32370dfaca6b7317328ac5c08869335 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 29 Aug 2019 09:24:13 -0700
 Subject: [PATCH 20/46] x86/mm: Update pte_modify and pmd_modify for _PAGE_COW
@@ -82,5 +82,5 @@ index fd03ed24ef65..b76b9491e11f 100644
  	return __pmd(val);
  }
 -- 
-2.26.0
+2.26.1
 
diff --git a/0021-x86-mm-Update-ptep_set_wrprotect-and-pmdp_set_wrprot.patch b/0021-x86-mm-Update-ptep_set_wrprotect-and-pmdp_set_wrprot.patch
index 464fa9bcb..950fdcfef 100644
--- a/0021-x86-mm-Update-ptep_set_wrprotect-and-pmdp_set_wrprot.patch
+++ b/0021-x86-mm-Update-ptep_set_wrprotect-and-pmdp_set_wrprot.patch
@@ -1,4 +1,4 @@
-From 9baa1f751d088e170153debf1f6fc3d01d13aa24 Mon Sep 17 00:00:00 2001
+From c7c743ec52a2c96212a048e0d5011dc6e80dcc21 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Fri, 15 Jun 2018 09:33:40 -0700
 Subject: [PATCH 21/46] x86/mm: Update ptep_set_wrprotect() and
@@ -115,5 +115,5 @@ index b76b9491e11f..0270e04e3505 100644
  }
  
 -- 
-2.26.0
+2.26.1
 
diff --git a/0022-mm-Introduce-VM_SHSTK-for-Shadow-Stack-memory.patch b/0022-mm-Introduce-VM_SHSTK-for-Shadow-Stack-memory.patch
index 4a53662fc..c6c4e9218 100644
--- a/0022-mm-Introduce-VM_SHSTK-for-Shadow-Stack-memory.patch
+++ b/0022-mm-Introduce-VM_SHSTK-for-Shadow-Stack-memory.patch
@@ -1,4 +1,4 @@
-From 16a928c9a89b9b11fbb4ce4eaa6f8e43366e105f Mon Sep 17 00:00:00 2001
+From edf3dfe3b124a17554a49a902e12b67c17382c1e Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Fri, 12 Jan 2018 15:04:54 -0800
 Subject: [PATCH 22/46] mm: Introduce VM_SHSTK for Shadow Stack memory
@@ -79,5 +79,5 @@ index 5a323422d783..54bb4cd9fee8 100644
  # define VM_GROWSUP	VM_NONE
  #endif
 -- 
-2.26.0
+2.26.1
 
diff --git a/0023-x86-mm-Shadow-Stack-page-fault-error-checking.patch b/0023-x86-mm-Shadow-Stack-page-fault-error-checking.patch
index fcb468b4d..c288c4b6a 100644
--- a/0023-x86-mm-Shadow-Stack-page-fault-error-checking.patch
+++ b/0023-x86-mm-Shadow-Stack-page-fault-error-checking.patch
@@ -1,4 +1,4 @@
-From 244f95ae55ebbb9ddbea707f151cb303442e59d6 Mon Sep 17 00:00:00 2001
+From c04abb64d583f5b2f84dce10e209191961454b5b Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 28 Nov 2017 13:01:18 -0800
 Subject: [PATCH 23/46] x86/mm: Shadow Stack page fault error checking
@@ -91,5 +91,5 @@ index a51df516b87b..e95eee82b48e 100644
  		flags |= FAULT_FLAG_WRITE;
  	if (hw_error_code & X86_PF_INSTR)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0024-x86-mm-Update-is_cow_mapping-and-maybe_mkwrite-for-s.patch b/0024-x86-mm-Update-is_cow_mapping-and-maybe_mkwrite-for-s.patch
index 229f6306a..124642881 100644
--- a/0024-x86-mm-Update-is_cow_mapping-and-maybe_mkwrite-for-s.patch
+++ b/0024-x86-mm-Update-is_cow_mapping-and-maybe_mkwrite-for-s.patch
@@ -1,4 +1,4 @@
-From f6bc7b365d6aa922be27900d40a9f8bab8731077 Mon Sep 17 00:00:00 2001
+From 6d55a34a6b5be63f505cc20edcbde9e3364eabd6 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 7 Apr 2020 16:03:36 -0700
 Subject: [PATCH 24/46] x86/mm: Update is_cow_mapping() and maybe_mkwrite() for
@@ -139,5 +139,5 @@ index b5634e78f01d..144b5abd7c0a 100644
  
  /*
 -- 
-2.26.0
+2.26.1
 
diff --git a/0025-mm-Update-do_anonymous_page-and-do_numa_page.patch b/0025-mm-Update-do_anonymous_page-and-do_numa_page.patch
index 318fbb787..f4174d00b 100644
--- a/0025-mm-Update-do_anonymous_page-and-do_numa_page.patch
+++ b/0025-mm-Update-do_anonymous_page-and-do_numa_page.patch
@@ -1,4 +1,4 @@
-From 4a6dbdbb9c032b9c3f7bc093b48328ee07fe106e Mon Sep 17 00:00:00 2001
+From 3951fb7e0e873b59d25859013354e3e1eeb50c21 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Mon, 13 Apr 2020 13:21:22 -0700
 Subject: [PATCH 25/46] mm: Update do_anonymous_page() and do_numa_page()
@@ -52,5 +52,5 @@ index 7160c1556f79..0fa59b1562c6 100644
  
  	ptep = pte_offset_map_lock(mm, pmdp, addr, &ptl);
 -- 
-2.26.0
+2.26.1
 
diff --git a/0026-mm-Update-can_follow_write_pte-for-Shadow-Stack.patch b/0026-mm-Update-can_follow_write_pte-for-Shadow-Stack.patch
index cb102edf1..234ce44dc 100644
--- a/0026-mm-Update-can_follow_write_pte-for-Shadow-Stack.patch
+++ b/0026-mm-Update-can_follow_write_pte-for-Shadow-Stack.patch
@@ -1,4 +1,4 @@
-From f4435ca6ff5098e3601843af248c9708187ad418 Mon Sep 17 00:00:00 2001
+From 7daa42ad1b2a7fcfe1876d9a0d44bdb10d61b3ea Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 3 Jul 2018 13:07:12 -0700
 Subject: [PATCH 26/46] mm: Update can_follow_write_pte() for Shadow Stack
@@ -78,5 +78,5 @@ index 608746bb9d19..c93db1a1587f 100644
  
  	/* Avoid dumping huge zero page */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0027-x86-mm-Add-guard-pages-around-a-Shadow-Stack.patch b/0027-x86-mm-Add-guard-pages-around-a-Shadow-Stack.patch
index 192fe7534..b56afb164 100644
--- a/0027-x86-mm-Add-guard-pages-around-a-Shadow-Stack.patch
+++ b/0027-x86-mm-Add-guard-pages-around-a-Shadow-Stack.patch
@@ -1,4 +1,4 @@
-From 96d704f5a2453bb2c761d28306db4377d04e3b54 Mon Sep 17 00:00:00 2001
+From 3051fdf2a90141f0e8094506e183a38bb254e16d Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Fri, 4 Oct 2019 14:00:58 -0700
 Subject: [PATCH 27/46] x86/mm: Add guard pages around a Shadow Stack.
@@ -96,5 +96,5 @@ index f0669e3cdd37..68eadf2c466d 100644
  			vm_end = -PAGE_SIZE;
  	}
 -- 
-2.26.0
+2.26.1
 
diff --git a/0028-mm-mmap-Add-Shadow-Stack-pages-to-memory-accounting.patch b/0028-mm-mmap-Add-Shadow-Stack-pages-to-memory-accounting.patch
index 58caba5fb..d708c7faa 100644
--- a/0028-mm-mmap-Add-Shadow-Stack-pages-to-memory-accounting.patch
+++ b/0028-mm-mmap-Add-Shadow-Stack-pages-to-memory-accounting.patch
@@ -1,4 +1,4 @@
-From 8c5106741e1026bca6af8f2ad80dfcefc0d8c753 Mon Sep 17 00:00:00 2001
+From 48b7ab7747e78297173dc1ffec3d68d467943882 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 13 Sep 2018 12:36:48 -0700
 Subject: [PATCH 28/46] mm/mmap: Add Shadow Stack pages to memory accounting
@@ -79,5 +79,5 @@ index f609e9ec4a25..70d240b3559c 100644
  
  static vm_fault_t special_mapping_fault(struct vm_fault *vmf);
 -- 
-2.26.0
+2.26.1
 
diff --git a/0029-x86-cet-shstk-User-mode-Shadow-Stack-support.patch b/0029-x86-cet-shstk-User-mode-Shadow-Stack-support.patch
index fbba25f01..394a46705 100644
--- a/0029-x86-cet-shstk-User-mode-Shadow-Stack-support.patch
+++ b/0029-x86-cet-shstk-User-mode-Shadow-Stack-support.patch
@@ -1,4 +1,4 @@
-From 2dcb1cd7a907f9289ece4311ea3f84d2aab7c0d7 Mon Sep 17 00:00:00 2001
+From e722491314061fb1d50fb75409f7a89e3ca8f47f Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 22 Aug 2019 10:06:11 -0700
 Subject: [PATCH 29/46] x86/cet/shstk: User-mode Shadow Stack support
@@ -136,7 +136,7 @@ index ba89cabe5fcf..e9cc2551573b 100644
  ifeq ($(CONFIG_X86_64),y)
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
 new file mode 100644
-index 000000000000..56113a1338af
+index 000000000000..d8196c8e792a
 --- /dev/null
 +++ b/arch/x86/kernel/cet.c
 @@ -0,0 +1,135 @@
@@ -265,7 +265,7 @@ index 000000000000..56113a1338af
 +		 * Retry if mmap_sem is not available.
 +		 */
 +		if (r == -EINTR) {
-+			might_sleep();
++			cond_resched();
 +			continue;
 +		}
 +
@@ -367,5 +367,5 @@ index 4ea8584682f9..a0e1b24cfa02 100644
  #define DISABLED_MASK18	0
  #define DISABLED_MASK_CHECK BUILD_BUG_ON_ZERO(NCAPINTS != 19)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0030-x86-cet-shstk-Handle-signals-for-Shadow-Stack.patch b/0030-x86-cet-shstk-Handle-signals-for-Shadow-Stack.patch
index 7f6996535..02c47704a 100644
--- a/0030-x86-cet-shstk-Handle-signals-for-Shadow-Stack.patch
+++ b/0030-x86-cet-shstk-Handle-signals-for-Shadow-Stack.patch
@@ -1,4 +1,4 @@
-From 3f7b50666a8575a4bee295c45aea544df58948d8 Mon Sep 17 00:00:00 2001
+From d8de779fe78febd77434edc7a77e28481e436e55 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 5 Jan 2017 13:48:31 -0800
 Subject: [PATCH 30/46] x86/cet/shstk: Handle signals for Shadow Stack
@@ -199,7 +199,7 @@ index 844d60eb1882..cf2d55db3be4 100644
   * The 32-bit signal frame:
   */
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
-index 56113a1338af..c9344ad50ba5 100644
+index d8196c8e792a..8f3b2cd95a2f 100644
 --- a/arch/x86/kernel/cet.c
 +++ b/arch/x86/kernel/cet.c
 @@ -19,6 +19,8 @@
@@ -547,5 +547,5 @@ index 0052bbe5dfd4..059b8cbc6a32 100644
  	ret = copy_fpstate_to_sigframe(*fpstate, (void __user *)buf_fx, math_size);
  	if (ret < 0)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0031-ELF-UAPI-and-Kconfig-additions-for-ELF-program-prope.patch b/0031-ELF-UAPI-and-Kconfig-additions-for-ELF-program-prope.patch
index 9e7da60d0..b81ab99bb 100644
--- a/0031-ELF-UAPI-and-Kconfig-additions-for-ELF-program-prope.patch
+++ b/0031-ELF-UAPI-and-Kconfig-additions-for-ELF-program-prope.patch
@@ -1,4 +1,4 @@
-From 9be1304eb0a3c5f80caa41c37f77a9ff9c254ed7 Mon Sep 17 00:00:00 2001
+From 51e4eb695cda8f3ead009a750155529d90d49d5e Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Fri, 18 Oct 2019 18:25:34 +0100
 Subject: [PATCH 31/46] ELF: UAPI and Kconfig additions for ELF program
@@ -81,5 +81,5 @@ index 34c02e4290fe..61251ecabdd7 100644
 +
  #endif /* _UAPI_LINUX_ELF_H */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0032-ELF-Add-ELF-program-property-parsing-support.patch b/0032-ELF-Add-ELF-program-property-parsing-support.patch
index 536921552..e940b5008 100644
--- a/0032-ELF-Add-ELF-program-property-parsing-support.patch
+++ b/0032-ELF-Add-ELF-program-property-parsing-support.patch
@@ -1,4 +1,4 @@
-From 56fdfaccaffea8049fa14ff0e08bca4b8b2f0b9c Mon Sep 17 00:00:00 2001
+From 6d78f2d83d8cc62daab91870ce9e0c5fecc90632 Mon Sep 17 00:00:00 2001
 From: Dave Martin <Dave.Martin@arm.com>
 Date: Mon, 16 Mar 2020 16:50:44 +0000
 Subject: [PATCH 32/46] ELF: Add ELF program property parsing support
@@ -306,5 +306,5 @@ index 61251ecabdd7..518651708d8f 100644
  typedef struct elf32_note {
    Elf32_Word	n_namesz;	/* Name size */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0033-ELF-Introduce-arch_setup_elf_property.patch b/0033-ELF-Introduce-arch_setup_elf_property.patch
index a6784e045..b64dc0a3d 100644
--- a/0033-ELF-Introduce-arch_setup_elf_property.patch
+++ b/0033-ELF-Introduce-arch_setup_elf_property.patch
@@ -1,4 +1,4 @@
-From 16aaa6256ad77c75d12346a4b6b1f0793483371e Mon Sep 17 00:00:00 2001
+From cc398d898c51f15a4b24367a53246e73c244c3d3 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 20 Aug 2019 13:20:37 -0700
 Subject: [PATCH 33/46] ELF: Introduce arch_setup_elf_property()
@@ -51,5 +51,5 @@ index 7bdc6da160c7..81f2161fa4a8 100644
  
  #endif /* _LINUX_ELF_H */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0034-x86-cet-shstk-ELF-header-parsing-for-Shadow-Stack.patch b/0034-x86-cet-shstk-ELF-header-parsing-for-Shadow-Stack.patch
index ab4a5eeed..08dec9865 100644
--- a/0034-x86-cet-shstk-ELF-header-parsing-for-Shadow-Stack.patch
+++ b/0034-x86-cet-shstk-ELF-header-parsing-for-Shadow-Stack.patch
@@ -1,4 +1,4 @@
-From a7595ab5fdbacd7e6fa907323410650a1f615e52 Mon Sep 17 00:00:00 2001
+From d4f4d7405b882516ebb1cc5e2ca862cc4f089eeb Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 3 Oct 2017 16:07:12 -0700
 Subject: [PATCH 34/46] x86/cet/shstk: ELF header parsing for Shadow Stack
@@ -91,5 +91,5 @@ index 5ef9d8f25b0e..93ba4afd0c19 100644
 +}
 +#endif
 -- 
-2.26.0
+2.26.1
 
diff --git a/0035-x86-cet-shstk-Handle-thread-Shadow-Stack.patch b/0035-x86-cet-shstk-Handle-thread-Shadow-Stack.patch
index d0dee74bc..349b19bc6 100644
--- a/0035-x86-cet-shstk-Handle-thread-Shadow-Stack.patch
+++ b/0035-x86-cet-shstk-Handle-thread-Shadow-Stack.patch
@@ -1,4 +1,4 @@
-From 3f307a583b6257b954e521c6278aef8d2bba25da Mon Sep 17 00:00:00 2001
+From 711aa4e9494076635becbeb13201c13b3fe31461 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 3 May 2018 12:40:57 -0700
 Subject: [PATCH 35/46] x86/cet/shstk: Handle thread Shadow Stack
@@ -79,7 +79,7 @@ index 4e55370e48e8..bb7a4a2d6923 100644
  	loadsegment(fs, 0);			\
  } while (0)
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
-index c9344ad50ba5..afedfbee420a 100644
+index 8f3b2cd95a2f..e0c3915db10f 100644
 --- a/arch/x86/kernel/cet.c
 +++ b/arch/x86/kernel/cet.c
 @@ -169,6 +169,47 @@ int cet_setup_shstk(void)
@@ -156,5 +156,5 @@ index 9d9cff2c1018..ef1c2b8086a2 100644
  		io_bitmap_share(p);
  
 -- 
-2.26.0
+2.26.1
 
diff --git a/0036-x86-cet-shstk-Add-arch_prctl-functions-for-Shadow-St.patch b/0036-x86-cet-shstk-Add-arch_prctl-functions-for-Shadow-St.patch
index 8ca520d74..e538ff56b 100644
--- a/0036-x86-cet-shstk-Add-arch_prctl-functions-for-Shadow-St.patch
+++ b/0036-x86-cet-shstk-Add-arch_prctl-functions-for-Shadow-St.patch
@@ -1,4 +1,4 @@
-From dc64f44727fe86d07fb99d13cfe10223c480a188 Mon Sep 17 00:00:00 2001
+From 396f691ecd6cf6b70f2154be575957dfa3348409 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 3 May 2018 13:04:29 -0700
 Subject: [PATCH 36/46] x86/cet/shstk: Add arch_prctl functions for Shadow
@@ -96,7 +96,7 @@ index e9cc2551573b..0b621e2afbdc 100644
  ###
  # 64 bit specific files
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
-index afedfbee420a..a10699d79b54 100644
+index e0c3915db10f..646cb05b5896 100644
 --- a/arch/x86/kernel/cet.c
 +++ b/arch/x86/kernel/cet.c
 @@ -145,6 +145,35 @@ static int create_rstor_token(bool ia32, unsigned long ssp,
@@ -243,5 +243,5 @@ index ef1c2b8086a2..de6773dd6a16 100644
 -	return -EINVAL;
  }
 -- 
-2.26.0
+2.26.1
 
diff --git a/0037-x86-cet-ibt-Add-Kconfig-option-for-user-mode-Indirec.patch b/0037-x86-cet-ibt-Add-Kconfig-option-for-user-mode-Indirec.patch
index cb0e6f478..7285db215 100644
--- a/0037-x86-cet-ibt-Add-Kconfig-option-for-user-mode-Indirec.patch
+++ b/0037-x86-cet-ibt-Add-Kconfig-option-for-user-mode-Indirec.patch
@@ -1,4 +1,4 @@
-From f2e80a54916cd51a5c4dbeca6046c45883fdb45f Mon Sep 17 00:00:00 2001
+From ed198287388e9b4ebeda804686ecbc059cb0740b Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Wed, 4 Oct 2017 12:35:32 -0700
 Subject: [PATCH 37/46] x86/cet/ibt: Add Kconfig option for user-mode Indirect
@@ -48,5 +48,5 @@ index 561cc1632a2b..e769a55e07ed 100644
  	bool "EFI runtime service support"
  	depends on ACPI
 -- 
-2.26.0
+2.26.1
 
diff --git a/0038-x86-cet-ibt-User-mode-Indirect-Branch-Tracking-suppo.patch b/0038-x86-cet-ibt-User-mode-Indirect-Branch-Tracking-suppo.patch
index dd8f70b2b..85f92e5e3 100644
--- a/0038-x86-cet-ibt-User-mode-Indirect-Branch-Tracking-suppo.patch
+++ b/0038-x86-cet-ibt-User-mode-Indirect-Branch-Tracking-suppo.patch
@@ -1,4 +1,4 @@
-From fd5925b254106d88b395a11e20ef836fb53368cb Mon Sep 17 00:00:00 2001
+From f3c16a33b95a3623780d00dd4635537b69ffd64e Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Thu, 3 May 2018 13:30:56 -0700
 Subject: [PATCH 38/46] x86/cet/ibt: User-mode Indirect Branch Tracking support
@@ -72,7 +72,7 @@ index a0e1b24cfa02..52c9c07cfacc 100644
  
  #endif /* _ASM_X86_DISABLED_FEATURES_H */
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
-index a10699d79b54..ad2c42a607ce 100644
+index 646cb05b5896..3ea81bb32c8e 100644
 --- a/arch/x86/kernel/cet.c
 +++ b/arch/x86/kernel/cet.c
 @@ -13,6 +13,8 @@
@@ -174,5 +174,5 @@ index a0e1b24cfa02..52c9c07cfacc 100644
  
  #endif /* _ASM_X86_DISABLED_FEATURES_H */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0039-x86-cet-ibt-Handle-signals-for-Indirect-Branch-Track.patch b/0039-x86-cet-ibt-Handle-signals-for-Indirect-Branch-Track.patch
index 72b180e9c..0f63bec88 100644
--- a/0039-x86-cet-ibt-Handle-signals-for-Indirect-Branch-Track.patch
+++ b/0039-x86-cet-ibt-Handle-signals-for-Indirect-Branch-Track.patch
@@ -1,4 +1,4 @@
-From f827066c9f71d6f82b08d3f494e27e8a5f4f1f96 Mon Sep 17 00:00:00 2001
+From 3f46fb1a263e51d77446fe5b8432230f9307960d Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 28 May 2019 12:29:14 -0700
 Subject: [PATCH 39/46] x86/cet/ibt: Handle signals for Indirect Branch
@@ -22,7 +22,7 @@ Signed-off-by: Yu-cheng Yu <yu-cheng.yu@intel.com>
  2 files changed, 30 insertions(+), 5 deletions(-)
 
 diff --git a/arch/x86/kernel/cet.c b/arch/x86/kernel/cet.c
-index ad2c42a607ce..37445f49949b 100644
+index 3ea81bb32c8e..a8a8c117f1e0 100644
 --- a/arch/x86/kernel/cet.c
 +++ b/arch/x86/kernel/cet.c
 @@ -312,6 +312,13 @@ int cet_restore_signal(bool ia32, struct sc_ext *sc_ext)
@@ -101,5 +101,5 @@ index 8862d3edbf34..af047395d14a 100644
  
  	return sp;
 -- 
-2.26.0
+2.26.1
 
diff --git a/0040-x86-cet-ibt-ELF-header-parsing-for-Indirect-Branch-T.patch b/0040-x86-cet-ibt-ELF-header-parsing-for-Indirect-Branch-T.patch
index 3d29fcf57..b337a6f59 100644
--- a/0040-x86-cet-ibt-ELF-header-parsing-for-Indirect-Branch-T.patch
+++ b/0040-x86-cet-ibt-ELF-header-parsing-for-Indirect-Branch-T.patch
@@ -1,4 +1,4 @@
-From 2bb7618b0a3f8bbe5352b72e1e6d76021e291121 Mon Sep 17 00:00:00 2001
+From 3fa213a8f9697559db1637bfeb538abdcc43b971 Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Tue, 30 Apr 2019 15:16:22 -0700
 Subject: [PATCH 40/46] x86/cet/ibt: ELF header parsing for Indirect Branch
@@ -48,5 +48,5 @@ index 93ba4afd0c19..b7ab2030010b 100644
  }
  #endif
 -- 
-2.26.0
+2.26.1
 
diff --git a/0041-x86-cet-ibt-Add-arch_prctl-functions-for-Indirect-Br.patch b/0041-x86-cet-ibt-Add-arch_prctl-functions-for-Indirect-Br.patch
index 7a755508f..2190784eb 100644
--- a/0041-x86-cet-ibt-Add-arch_prctl-functions-for-Indirect-Br.patch
+++ b/0041-x86-cet-ibt-Add-arch_prctl-functions-for-Indirect-Br.patch
@@ -1,4 +1,4 @@
-From ee1dbbdd1cf83a21712ab6aa33902af7af48623b Mon Sep 17 00:00:00 2001
+From 2fa078b6e28d1feae5bd13e9cfa404c54a7f8801 Mon Sep 17 00:00:00 2001
 From: "H.J. Lu" <hjl.tools@gmail.com>
 Date: Tue, 21 Aug 2018 14:13:05 -0700
 Subject: [PATCH 41/46] x86/cet/ibt: Add arch_prctl functions for Indirect
@@ -46,5 +46,5 @@ index 0b4df3cbe2de..c3c8de3b0321 100644
  		return 0;
  
 -- 
-2.26.0
+2.26.1
 
diff --git a/0042-x86-cet-Add-PTRACE-interface-for-CET.patch b/0042-x86-cet-Add-PTRACE-interface-for-CET.patch
index 37db79302..0380a048a 100644
--- a/0042-x86-cet-Add-PTRACE-interface-for-CET.patch
+++ b/0042-x86-cet-Add-PTRACE-interface-for-CET.patch
@@ -1,4 +1,4 @@
-From 90ef8016b50b1407aa9ce4a3d0cb0f814f158f97 Mon Sep 17 00:00:00 2001
+From 51da9e418a3333e45a06b1fd91ea8d49e8a1531a Mon Sep 17 00:00:00 2001
 From: Yu-cheng Yu <yu-cheng.yu@intel.com>
 Date: Mon, 23 Apr 2018 12:55:13 -0700
 Subject: [PATCH 42/46] x86/cet: Add PTRACE interface for CET
@@ -143,5 +143,5 @@ index 518651708d8f..793f171c37c2 100644
  #define NT_S390_TIMER	0x301		/* s390 timer register */
  #define NT_S390_TODCMP	0x302		/* s390 TOD clock comparator register */
 -- 
-2.26.0
+2.26.1
 
diff --git a/0043-Discard-.note.gnu.property-sections-in-generic-NOTES.patch b/0043-Discard-.note.gnu.property-sections-in-generic-NOTES.patch
index f51f3c95c..fba56501a 100644
--- a/0043-Discard-.note.gnu.property-sections-in-generic-NOTES.patch
+++ b/0043-Discard-.note.gnu.property-sections-in-generic-NOTES.patch
@@ -1,4 +1,4 @@
-From 3fe6ac11063803a36ebb511d6d3b5258a1b78c46 Mon Sep 17 00:00:00 2001
+From 31c6689632b4c2f0ca12d4b027e7ce5a13b82009 Mon Sep 17 00:00:00 2001
 From: "H.J. Lu" <hjl.tools@gmail.com>
 Date: Thu, 30 Jan 2020 12:39:09 -0800
 Subject: [PATCH 43/46] Discard .note.gnu.property sections in generic NOTES
@@ -77,5 +77,5 @@ index 71e387a5fe90..95cd678428f4 100644
  		__start_notes = .;					\
  		KEEP(*(.note.*))					\
 -- 
-2.26.0
+2.26.1
 
diff --git a/0044-x86-vdso-32-Add-ENDBR32-to-__kernel_vsyscall-entry-p.patch b/0044-x86-vdso-32-Add-ENDBR32-to-__kernel_vsyscall-entry-p.patch
index 9a7939fd1..b453b5c30 100644
--- a/0044-x86-vdso-32-Add-ENDBR32-to-__kernel_vsyscall-entry-p.patch
+++ b/0044-x86-vdso-32-Add-ENDBR32-to-__kernel_vsyscall-entry-p.patch
@@ -1,4 +1,4 @@
-From 30ef0ae1c022469caec750ab52b208d37503b41c Mon Sep 17 00:00:00 2001
+From 8d971bbd8af2317d560d2cac27e958838d06d791 Mon Sep 17 00:00:00 2001
 From: "H.J. Lu" <hjl.tools@gmail.com>
 Date: Fri, 28 Sep 2018 06:21:50 -0700
 Subject: [PATCH 44/46] x86/vdso/32: Add ENDBR32 to __kernel_vsyscall entry
@@ -28,5 +28,5 @@ index de1fff7188aa..5cf74ebd4746 100644
  	 * Reshuffle regs so that all of any of the entry instructions
  	 * will preserve enough state.
 -- 
-2.26.0
+2.26.1
 
diff --git a/0045-x86-vdso-Insert-endbr32-endbr64-to-vDSO.patch b/0045-x86-vdso-Insert-endbr32-endbr64-to-vDSO.patch
index e182c8a1d..cc70dc7a2 100644
--- a/0045-x86-vdso-Insert-endbr32-endbr64-to-vDSO.patch
+++ b/0045-x86-vdso-Insert-endbr32-endbr64-to-vDSO.patch
@@ -1,4 +1,4 @@
-From d33c06ab43b5b907345313c697c0163baa832ab9 Mon Sep 17 00:00:00 2001
+From dd790296beabad3216cc1408de9c4829f6e4d8ee Mon Sep 17 00:00:00 2001
 From: "H.J. Lu" <hjl.tools@gmail.com>
 Date: Fri, 16 Mar 2018 04:18:48 -0700
 Subject: [PATCH 45/46] x86/vdso: Insert endbr32/endbr64 to vDSO
@@ -31,5 +31,5 @@ index 433a1259f61d..6de3493acfe4 100644
  $(obj)/%.so: $(obj)/%.so.dbg FORCE
  	$(call if_changed,objcopy)
 -- 
-2.26.0
+2.26.1
 
diff --git a/0046-x86-Disallow-vsyscall-emulation-when-CET-is-enabled.patch b/0046-x86-Disallow-vsyscall-emulation-when-CET-is-enabled.patch
index 40f4aae50..8559423cf 100644
--- a/0046-x86-Disallow-vsyscall-emulation-when-CET-is-enabled.patch
+++ b/0046-x86-Disallow-vsyscall-emulation-when-CET-is-enabled.patch
@@ -1,4 +1,4 @@
-From 7e8368b1af08d4a3f7b8456bdffb4cd8760a5bc3 Mon Sep 17 00:00:00 2001
+From e277d2d98b2eef754fa0ee4a4d94c6e2913d169f Mon Sep 17 00:00:00 2001
 From: "H.J. Lu" <hjl.tools@gmail.com>
 Date: Wed, 29 Jan 2020 08:44:11 -0800
 Subject: [PATCH 46/46] x86: Disallow vsyscall emulation when CET is enabled
@@ -55,5 +55,5 @@ index 283ad77e0eb0..86c224f670e8 100644
  		bool "Full emulation"
  		help
 -- 
-2.26.0
+2.26.1
 
-- 
2.26.1

